<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Archived Articles</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<h1>Archived Articles</h1>
<table>
    <thead>
        <tr>
            <th>Title</th>
            <th>Author</th>
            <th>Status</th>
            <th>Editor</th>
            <th>Deadline</th>
            <th>Files</th>
        </tr>
    </thead>
    <tbody>
        {% for article in articles %}
        <tr>
            <td>{{ article.title }}</td>
            <td>{{ article.author }}</td>
            <td>{{ article.status }}</td>
            <td>{{ article.editor }}</td>
            <td>{{ article.deadline }}</td>
            <td><button onclick="openFileManager({{ article.id }})">Files</button></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</body>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
const socket = io();

// Add new archived article live
socket.on('article_archived', data => {
    if (!document.getElementById(`archived-row-${data.id}`)) {
        const tbody = document.querySelector('table tbody');
        const row = document.createElement('tr');
        row.id = `archived-row-${data.id}`;
        row.innerHTML = `
            <td>${data.title}</td>
            <td>${data.author}</td>
            <td>${data.status}</td>
            <td>${data.editor || ''}</td>
            <td>${data.deadline || ''}</td>
            <td><button onclick="openFileManager(${data.id})">Files</button></td>
        `;
        tbody.appendChild(row);
    }
});
</script>
</html>
